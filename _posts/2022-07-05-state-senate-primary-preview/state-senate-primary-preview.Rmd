---
title: "An overview of the 2022 State Senate Primaries"
description: |
    A short discussion of redistricting and an overview
    of each State Senate primary race.
author:
  - name: Brent Benson
    url: https://twitter.com/bwbensonjr
date: 2022-07-09
preview: images/berk_hamp_frank_hamp.png
output:
  distill::distill_article:
    self_contained: false
---

```{r libraries, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)
options(digits=1, knitr.kable.NA="")
library(kableExtra)
library(tidyverse)
library(sf)
library(tmap)
library(readxl)
library(viridis)
library(tidycensus)
library(tigris)
library(units)
library(nominatimlite)
```
```{r senate-districts}
sen_dist <- read_excel("../../_data/2020/MA_State_Senate_Race_2022.xlsx", sheet="Districts")

sen_cand <- read_csv("../../_data/2020/ma_state_senate_cands_2022_contested_addr.csv") %>%
    rename(Inc = Incumbent) %>%
    mutate(address = str_c(street_address, city_town, "MA", sep=", ")) %>%
    select(-street_address)

sen_geom <- read_sf("../../_gis/SENATE2021/SENATE2021_POLY.shp", as_tibble=TRUE) %>%
    st_make_valid() %>%
    select(Number=SENDISTNUM) %>%
    st_transform(st_crs(6491)) %>%
    left_join(sen_dist, by="Number") %>%
    relocate(District)

sen_geom_12 <- read_sf("../../_gis/senate2012/SENATE2012_POLY.shp", as_tibble=TRUE) %>%
    st_make_valid() %>%
    st_transform(st_crs(6491))

tmap_mode(mode="view")
one_m_sq <- set_units(1, m^2)
two_k_m_sq <- set_units(2000, m^2)
five_k_m_sq <- set_units(5000, m^2)
```

It may be the middle of summer, but there is a lot going on in Massachusetts
state legislature campaigns. This post spends some time looking at
redistricting, specifically the new majority minority state senate districts,
and then at each of the contested state senate primaries.

## New majority minority districts

The Massachusetts State Senate lines have been redrawn by the legislature after
the 2020 Census as required by the constitution. Redistricting established
two new majority minority districts.

The First Essex State Senate District—one of the new majority
districts—contains all of Lawrence, all of Methuen, and approximately
5 precincts of Haverhill (give or take a few census blocks). The
previous lines of the district (the dotted line in the map below) did
not include Lawrence and instead included a large number of largely
white communities. The new lines result in a voting age population
that is 36% White, 56% Hispanic, 10% Black, and 3% Asian. The First
Essex incumbent, Diana DiZoglio (D—Methuen), is running for Auditor,
leaving an open race for a competitive field of candidates from
Lawrence and Methuen (see the First Essex primary overview below).

```{r first-essex-redist, layout="l-body-outset", fig.cap="*First Essex State Senate District*"}
sen_19 <- sen_geom %>% filter(Number == 19)
sen_old_19 <- sen_geom_12 %>% filter(SEN_DIST == "First Essex")

sen_19_map <- (
    tm_shape(sen_19, bbox=st_bbox(st_union(sen_19, sen_old_19))) +
        tm_fill(col = viridis(1), alpha = 0.5) +
        tm_shape(sen_old_19) +
        tm_borders(lwd = 2, lty = "dashed") +
        tm_basemap("OpenStreetMap")
)
tmap_leaflet(sen_19_map)
```

The other newly created majority minority is the Middlesex and Suffolk District
with incumbent Sal DiDomenico (D—Everett). Redistricting has added diverse
sections of Cambridgeport and East Cambridge, while removing parts of Boston's
West End, Allston, and Brighton neighborhoods. The district ends up with a
demographic mix of 46% White, 24% Hispanic, 12% Black, and 15% Asian. DiDomenico
does not have primary or general election challenger.

```{r middlesex-and-suffolk-redist, layout="l-body-outset", fig.cap="*Middlesex and Suffolk State Senate District*"}
sen_26 <- sen_geom %>% filter(Number == 26)
sen_old_26 <- sen_geom_12 %>% filter(SEN_DIST == "Middlesex and Suffolk")

sen_26_map <- (
    tm_shape(sen_26) +
        tm_fill(col = viridis(1), alpha = 0.5) +
        tm_shape(sen_old_26) +
        tm_borders(lwd = 2, lty = "dashed") +
        tm_basemap("OpenStreetMap")
)
tmap_leaflet(sen_26_map)
```

The other majority minority State Senate districts are the Springfield-based
Hampden district of Adam Gomez (D—Springfield), the Boston-based Second Suffolk
district of Sonia Change-Diaz (D—Boston) who ran an unsuccessful campaign for
Governor, and the Second Plymouth and Norfolk district with incumbent
Senator Michael Brady (D—Brockton).

The full State Senate map is given here with dashed lines for previous State
Senate district lines and some demographics (partisan lean, etc.).

```{r new-district-map, layout="l-body-outset", fig.cap="*MA State Senate Districts (2022)*"}
new_sen_map <- (tm_shape(sen_geom) +
                    tm_borders(lwd=2) +
                    tm_fill(col="PVI_N",
                            palette=c("#FF4949", "white", "#0F4392"),
                            midpoint=0,
                            alpha=0.5,
                            popup.vars=c("Incumbent",
                                         "PVI",
                                         "NH_White_Pct",
                                         "Old District",
                                         "primaries")) +
                    tm_shape(sen_geom_12) +
                    tm_borders(lwd=2, lty="dashed") +
                    tm_basemap("OpenStreetMap"))
tmap_leaflet(new_sen_map)
```

## State Senate Primary Overview

There are ten State Senate districts with contested primaries. There are three
Democratic incumbents with primary challengers—Joan Lovely (D—Salem), Walter
Timility (D—Milton), Michael Brady (D-Brockton)—and one Republican with a
primary challenge, Patrick O'Connor (R-Weymouth).

There are five open seats with four having just a Democratic primary, and one
seat—Hampden, Hampshire and Worcester—with both a Democratic and Republican
primary.

```{r state-senate-districts}
sen_dist %>% select(c(District,
                      PVI,
                      inc_status,
                      Incumbent,
                      primaries)) %>%
    kbl() %>%
    kable_styling()
```

```{r district-setup}
vtd_to_city_town <- read_csv("../../_data/2020/ma_vtds_city_town_fips.csv") %>%
    select(vtd_fips, city_town, Ward, Pct, city_town_fips, type)

ma_vtds <- voting_districts(state=25) %>%
    rename(state_code = STATEFP20,
           county_code = COUNTYFP20,
           vtd_code = VTDST20,
           vtd_fips = GEOID20) %>%
    filter(vtd_code != "ZZZZZZ") %>%
    left_join(vtd_to_city_town, by="vtd_fips") %>%
    st_transform(st_crs(6491))

ma_towns <- read_sf("../../_gis/townssurvey_shp/TOWNSSURVEY_POLYM.shp",
                    as_tibble=TRUE) %>%
    st_make_valid() %>%
    mutate(city_town = str_to_title(TOWN)) %>%
    select(city_town) %>%
    st_transform(st_crs(6491))

ma_towns_dems <- read_csv("../../_data/2020/ma_city_town_demographics_pvi_2020.csv") %>%
    mutate(city_town = str_replace(city_town, "Manchester-by-the-Sea", "Manchester")) %>%
    rename(white_pct = race_white_pct,
           black_pct = race_black_pct,
           hispanic_pct = race_hispanic_pct,
           asian_pct = race_asian_pct) %>%
    select(city_town_fips, city_town, PVI, PVI_N, total_population,
           white_pct, black_pct, hispanic_pct, asian_pct)

ma_towns_geom <- merge(ma_towns, ma_towns_dems, by="city_town") %>%
    mutate(center = st_centroid(geometry))

ma_vtds_pvi <- read_csv("../../_data/2020/ma_precinct_pvi_2020.csv")
    
ma_vtds_dems <- read_csv("../../_data/2020/ma_census_2020_daves.csv") %>%
    rename(total_population = Tot_2020_tot) %>%
    mutate(white_pct = Wh_2020_tot/total_population,
           black_pct = BlC_2020_tot/total_population,
           hispanic_pct = His_2020_tot/total_population,
           asian_pct = AsnC_2020_tot/total_population) %>%
    select(vtd_fips, total_population, white_pct, black_pct,
           hispanic_pct, asian_pct)

ma_vtds_geom <- ma_vtds %>%
    mutate(center = st_centroid(geometry)) %>%
    left_join(ma_vtds_pvi, by=c("city_town", "Ward", "Pct")) %>%
    left_join(ma_vtds_dems, by="vtd_fips")

ma_sen <- read_sf("../../_gis/SENATE2021/SENATE2021_POLY.shp", as_tibble=TRUE) %>%
    st_make_valid() %>%
    select(SENDISTNUM, SEN_DIST) %>%
    st_transform(st_crs(6491))

ma_house_12 <- read_sf("../../_gis/house2012/HOUSE2012_POLY.shp", as_tibble=TRUE) %>%
    st_make_valid() %>%
    st_transform(st_crs(6491))

ma_city_town_num_pcts <- ma_vtds_geom %>%
    st_drop_geometry() %>%
    group_by(city_town) %>%
    summarize(num_precincts = n())

ward_precinct_name <- function(city_town, ward, precinct) {
    str_c(city_town,
          if_else(ward == "-", "", str_c("Ward ", ward)),
          str_c("Precinct ", precinct),
          sep=" ")
}

## Determine which towns and precincts are in the district.
## If a whole town is contained in the district, include the
## whole town, otherwise, include by precinct.
##
town_precinct_mix <- function(sen_dist_geom, towns_geom, vtds_geom, city_town_num_pcts) {
    towns <- st_intersection(sen_dist_geom, towns_geom) %>%
        filter(st_area(geometry) > five_k_m_sq)
    vtds <- st_intersection(sen_dist_geom, vtds_geom) %>%
        filter(st_area(geometry) > one_m_sq)
    num_pcts <- vtds %>%
        st_drop_geometry() %>%
        group_by(city_town) %>%
        summarize(num_precincts = n())
    completes <- num_pcts %>%
        left_join((city_town_num_pcts %>% rename(total_precincts = num_precincts)), by="city_town") %>%
        mutate(complete = (num_precincts == total_precincts))
    full_towns <- right_join(
            towns,
            (completes %>%
             filter(complete) %>%
             select(city_town)),
            by="city_town") %>% 
        select(name=city_town, PVI, PVI_N, total_population,
               white_pct, black_pct, hispanic_pct, asian_pct)
    precincts <- right_join(
            vtds,
            (completes %>%
             filter(!complete) %>%
             select(city_town)),
            by="city_town") %>%
        mutate(name=ward_precinct_name(city_town, Ward, Pct)) %>%
        select(name, PVI, PVI_N, total_population, white_pct,
               black_pct, hispanic_pct, asian_pct)
    towns_precincts <- rbind(full_towns, precincts)
    towns_precincts
}

## Return the candidates for a particular district and compute
## candidate locations for placing on map.
## 
candidate_locations <- function(cand_list, sen_dist_num) {
    cand_list %>%
        filter(SENDISTNUM == sen_dist_num) %>%
        relocate(Candidate) %>%
        mutate(geometry = (geo_lite_sf(address,
                                       limit=1,
                                       return_addresses=FALSE) %>%
                               pull(geometry))) %>%
        st_as_sf()
}

district_map <- function(sen_dist, towns_pcts, candidates, house_dist) {
    if (missing(house_dist)) {
        bbox <- NULL
    } else {
        bbox <- st_bbox(st_union(sen_dist, house_dist))
    }
    base_map <- (tm_shape(towns_pcts, bbox=bbox) +
                 tm_borders(lwd=0.5) +
                 tm_fill(col="PVI_N",
                         palette=c("#FF4949", "white", "#0F4392"),
                         midpoint=0,
                         alpha=0.5,
                         popup.vars=c("PVI", "total_population", "white_pct",
                                      "black_pct", "hispanic_pct", "asian_pct")) +
                 tm_shape(sen_dist) + tm_borders(lwd=3))
    if (!missing(house_dist)) {
        base_map <- base_map + (tm_shape(house_dist) + tm_borders(lwd=3, lty="dashed"))
    }
    (base_map + 
      tm_shape(candidates) +
      tm_symbols(ymod=-0.6, size=0.2, col="black", popup.vars=c("Party", "city_town")) +
      tm_basemap("OpenStreetMap"))
}

## Produce a readable version of candidates for a particular Senate district
candidate_table <- function(candidates, dist_num) {
    candidates %>%
        filter(SENDISTNUM == dist_num) %>%
        select(District,
               cpf_id,
               Inc,
               Candidate,
               Party,
               city_town) %>%
        kbl() %>%
        kable_styling()
}
```
## Berkshire, Hampden, Franklin and Hampshire

```{r bhfh-setup}
ma_sen_1 <- ma_sen %>%
    filter(SENDISTNUM == 1)

ma_towns_1 <-st_intersection(ma_sen_1, ma_towns_geom) %>%
    filter(st_area(geometry) > five_k_m_sq)

ma_house_berk_2 <- ma_house_12 %>%
    filter(DIST_CODE == "BERK02")

ma_sen_cands_1 <- candidate_locations(sen_cand, 1)

```

```{r bhfh-map, layout="l-body-outset", fig.cap="*Berkshire, Hampden, Franklin and Hampshire*   "}
ma_sen_1_map <- district_map(ma_sen_1, ma_towns_1, ma_sen_cands_1, ma_house_berk_2)
tmap_leaflet(ma_sen_1_map)
```

```{r bhfh-cand}
candidate_table(sen_cand, 1)
```

The newly created and enormous Berkshire, Hampden, Franklin and Hampshire
district contains 57 cities and towns in Western Massachusetts. The incumbent of
the existing and similarly named Berkshire, Hampshire, Franklin and Hampden
district, Adam Hinds (D—Pittsfield) ran an unsuccessful campaign for Lieutenant
Governor, leaving this district without an incumbent senator.

The Democratic primary will feature sitting State Representative Paul Mark
(D—Peru) whose current Second Berkshire State Representative district is 
outlined in the map, and Williamstown small business manager and activist
Huff Templeton III. Representative Mark will have a considerable advantage
as almost a quarter of the Senate district's Democratic primary voters will
have seen him on the ballot, and likely will have voted for him in the past.

The D+18 Partisan Voter Index (PVI) will make the winner of the Democratic
primary the prohibitive favorite in November's general election against
unenrolled candidate Brendan Phair of Pittsfield.

## Hampden, Hampshire and Worcester

```{r hhw-setup}
ma_sen_4 <- ma_sen %>%
    filter(SENDISTNUM == 4)

ma_towns_pcts_4 <- town_precinct_mix(
                        ma_sen_4,
                        ma_towns_geom,
                        ma_vtds_geom,
                        ma_city_town_num_pcts)

ma_house_hampd_7 <- ma_house_12 %>%
    filter(DIST_CODE == "HAMPD07")

ma_sen_cands_4 <- candidate_locations(sen_cand, 4)
```

```{r hhw-map, layout="l-body-outset", fig.cap="*Hampden, Hampshire and Worcester*m"}
ma_sen_4_map <- district_map(ma_sen_4, ma_towns_pcts_4, ma_sen_cands_4, ma_house_hampd_7)

tmap_leaflet(ma_sen_4_map)
```

```{r hhw-cand}
candidate_table(sen_cand, 4)
```

The new Hampden, Hampshire and Worcester district is closely related to the
previous First Hampden and Hampshire district currently held by Eric
Lesser (D—Longmeadow) who is running for Lieutenant Governor. It is the only
state senate seat to feature both a Democratic and Republican primary.

On the Democratic side, first term State Representative Jacob Oliveira
(D—Ludlow) faces campaign strategist Sydney Levin-Epstein of Longmeadow. The
map shows the overlap of the Oliveira-held Seventh Hampden State Rep district.

The two GOP candidates are John Harding of East Longmeadow, a former military
office who says he has been called by God to run, and William Johnson, a
business owner from Granby.

## First Worcester

```{r first-worc-setup}
ma_sen_9 <- ma_sen %>%
    filter(SENDISTNUM == 9)

ma_towns_pcts_9 <- town_precinct_mix(
                        ma_sen_9,
                        ma_towns_geom,
                        ma_vtds_geom,
                        ma_city_town_num_pcts)

ma_sen_cands_9 <- candidate_locations(sen_cand, 9)
```

```{r first-worc-map, layout="l-body-outset", fig.cap="*Hampden, Hampshire and Worcester*m"}
ma_sen_9_map <- district_map(ma_sen_9, ma_towns_pcts_9, ma_sen_cands_9)

tmap_leaflet(ma_sen_9_map)
```

```{r first-worc-cand}
candidate_table(sen_cand, 9)
```

## First Essex

```{r first-essex-setup}
ma_sen_19 <- ma_sen %>%
    filter(SENDISTNUM == 19)

ma_towns_pcts_19 <- town_precinct_mix(
                        ma_sen_19,
                        ma_towns_geom,
                        ma_vtds_geom,
                        ma_city_town_num_pcts)

ma_sen_cands_19 <- candidate_locations(sen_cand, 19)
```

```{r first-essex-map, layout="l-body-outset", fig.cap="*First Essex Senate District*m"}
ma_sen_19_map <- district_map(ma_sen_19, ma_towns_pcts_19, ma_sen_cands_19)
tmap_leaflet(ma_sen_19_map)
```

```{r first-essex-cands}
candidate_table(sen_cand, 19)
```

## Second Essex

```{r second-essex-setup}
ma_sen_22 <- ma_sen %>%
    filter(SENDISTNUM == 22)

ma_towns_pcts_22 <- town_precinct_mix(
                        ma_sen_22,
                        ma_towns_geom,
                        ma_vtds_geom,
                        ma_city_town_num_pcts)

ma_sen_cands_22 <- candidate_locations(sen_cand, 22)
```

```{r second-essex-map, layout="l-body-outset", fig.cap="*Second Essex State Senate District*m"}
ma_sen_22_map <- district_map(ma_sen_22, ma_towns_pcts_22, ma_sen_cands_22)

tmap_leaflet(ma_sen_22_map)
```

```{r second-essex-cands}
candidate_table(sen_cand, 22)
```

## Second Suffolk

```{r second-suffolk-setup}
ma_sen_29 <- ma_sen %>%
    filter(SENDISTNUM == 29)

ma_towns_pcts_29 <- town_precinct_mix(
                        ma_sen_29,
                        ma_towns_geom,
                        ma_vtds_geom,
                        ma_city_town_num_pcts)

ma_sen_cands_29 <- candidate_locations(sen_cand, 29)
```

```{r second-suffolk-map, layout="l-body-outset", fig.cap="*Second Suffolk State Senate District*m"}
ma_sen_29_map <- district_map(ma_sen_29, ma_towns_pcts_29, ma_sen_cands_29)

tmap_leaflet(ma_sen_29_map)
```

```{r second-suffolk-cands}
candidate_table(sen_cand, 29)
```

## First Plymouth and Norfolk

```{r fpn-setup}
ma_sen_31 <- ma_sen %>%
    filter(SENDISTNUM == 31)

ma_towns_pcts_31 <- town_precinct_mix(
                        ma_sen_31,
                        ma_towns_geom,
                        ma_vtds_geom,
                        ma_city_town_num_pcts)

ma_sen_cands_31 <- candidate_locations(sen_cand, 31)
```

```{r fpn-map, layout="l-body-outset", fig.cap="*First Plymouth and Norfolk District*"}
ma_sen_31_map <- district_map(ma_sen_31, ma_towns_pcts_31, ma_sen_cands_31)

tmap_leaflet(ma_sen_31_map)
```

```{r fpn-cands}
candidate_table(sen_cand, 31)
```

## Norfolk, Plymouth and Bristol

```{r npb-setup}
ma_sen_33 <- ma_sen %>%
    filter(SENDISTNUM == 33)

ma_towns_pcts_33 <- town_precinct_mix(
                        ma_sen_33,
                        ma_towns_geom,
                        ma_vtds_geom,
                        ma_city_town_num_pcts)

ma_sen_cands_33 <- candidate_locations(sen_cand, 33)
```

```{r npb-map, layout="l-body-outset", fig.cap="*Norfolk, Plymouth and Bristol District*"}
ma_sen_33_map <- district_map(ma_sen_33, ma_towns_pcts_33, ma_sen_cands_33)

tmap_leaflet(ma_sen_33_map)
```

```{r npb-cands}
candidate_table(sen_cand, 33)
```

## Second Plymouth and Norfolk

```{r spn-setup}
ma_sen_34 <- ma_sen %>%
    filter(SENDISTNUM == 34)

ma_towns_pcts_34 <- town_precinct_mix(
                        ma_sen_34,
                        ma_towns_geom,
                        ma_vtds_geom,
                        ma_city_town_num_pcts)

ma_sen_cands_34 <- candidate_locations(sen_cand, 34)
```

```{r spn-map, layout="l-body-outset", fig.cap="*Second Plymouth and Norfolk*"}
ma_sen_34_map <- district_map(ma_sen_34, ma_towns_pcts_34, ma_sen_cands_34)

tmap_leaflet(ma_sen_34_map)
```

```{r spn-cands}
candidate_table(sen_cand, 34)
```

## Cape and Islands

```{r cape-islands-setup}
ma_sen_40 <- ma_sen %>%
    filter(SENDISTNUM == 40)

ma_towns_pcts_40 <- town_precinct_mix(
                        ma_sen_40,
                        ma_towns_geom,
                        ma_vtds_geom,
                        ma_city_town_num_pcts)

ma_sen_cands_40 <- candidate_locations(sen_cand, 40)
```

```{r cape-islands-map, layout="l-body-outset", fig.cap="*Second Plymouth and Norfolk*"}
ma_sen_40_map <- district_map(ma_sen_40, ma_towns_pcts_40, ma_sen_cands_40)

tmap_leaflet(ma_sen_40_map)
```

```{r cape-islands-cands}
candidate_table(sen_cand, 40)
```
